{% extends 'layouts/base.html' %}

{% block content %}
<!-- Scanner Modal (hidden by default) -->
<div id="scannerContainer" class="hidden fixed top-0 left-0 w-full h-full bg-black/50 flex justify-center items-center z-[9999]">
  <div id="scannerModal" class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-1/2 h-5/6 bg-amber-50 rounded-lg flex flex-col items-center">
    <div class="w-full h-full flex flex-col items-center gap-2">
      <div class="w-full h-12 flex items-center justify-center bg-slate-800 px-4 rounded-t-lg">
        <span class="text-xl font-bold text-white">üßü‚Äç‚ôÇÔ∏èInventory Scanner</span>
        <span class="ml-auto text-red-500 cursor-pointer text-2xl" onclick="closeScanner()">√ó</span>
      </div>
      <!-- Video feed -->
      <div class="flex-1 mx-4">
        <video id="camera-stream" class="w-full h-full" autoplay playsinline></video>
        <canvas id="annotatedCanvas" class="hidden w-full h-full"></canvas>
        <div id="loading" class="hidden w-full h-full flex justify-center items-center">
          <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-10 h-10 bg-gray-300 rounded-full animate-pulse"></div>
        </div>
      </div>
      <!-- Capture button -->
      <button id="capture-btn" class="mb-4 w-max mx-4 tracking-wide bg-slate-800 hover:bg-slate-600 px-4 py-2 rounded-md text-white font-bold transition-all duration-300">Scan Item</button>
    </div>
  </div>
</div>

<!-- Add to Inventory Popup Modal -->
<div id="addToInventoryModal" class="fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-white rounded-lg p-6 shadow-lg z-[10000] hidden flex flex-col items-center justify-center">
  <h3 class="text-xl font-bold mb-4">Add to Inventory?</h3>
  <p id="itemDetails" class="mb-4"></p>
  <div class="flex justify-end space-x-4">
    <button id="cancelAddBtn" class="px-4 py-2 bg-gray-300 rounded hover:bg-gray-400">Cancel</button>
    <button id="confirmAddBtn" class="px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600">Add</button>
  </div>
</div>
  
<div class="pc-container">
  <!-- Detail View Modal -->
  <div id="detailModal" class="fixed top-0 right-0 w-[30vw] h-screen bg-white shadow-lg p-8 z-[10000] transform translate-x-full transition-transform duration-300 ease-in-out">
    <span class="absolute top-4 right-4 text-2xl cursor-pointer" onclick="closeDetailModal()">√ó</span>
    <div id="detailContent" class="flex flex-col items-center">
      <h2 id="detailTitle" class="text-2xl font-bold mb-4"></h2>
      <img id="detailImage" class="w-full max-w-[200px] h-auto my-4" src="" alt="">
      <p id="detailDescription" class="my-4 leading-relaxed"></p>
    </div>
    <div class="flex flex-row mt-auto items-center justify-between">
      <button id="detailDeleteBtn" class="ml-auto px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600">Delete</button>
    </div>
  </div>
  <div id="modalOverlay" class="fixed top-0 left-0 w-full h-full bg-black/50 z-[9999] overflow-y-scroll hidden" onclick="closeDetailModal()"></div>

  <div class="flex flex-col items-center justify-center">
    <div class="w-full h-16 flex items-center justify-center pl-12 pr-8">
      <h1 class="text-3xl font-bold text-slate-800">Inventory</h1>
      <button id="openScannerBtn" class="ml-auto bg-slate-800 hover:bg-slate-600 px-4 py-2 rounded-md text-white font-bold transition-all duration-300">Add Items</button>
    </div>
    <div id="inventory" class="grid grid-cols-4 gap-4 p-4 mx-8">
    </div>
  </div>
</div>

<!-- JavaScript for Scanner functionality and annotation -->
<script src="{{ url_for('static', filename='assets/js/pages/inventory.js') }}"></script>
{% endblock %}
